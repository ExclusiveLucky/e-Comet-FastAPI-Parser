
# FastAPI GitHub Repos API

## Описание

Данное FastAPI-приложение предназначено для получения списка топ-100 публичных репозиториев с GitHub по количеству звёзд и анализа активности репозиториев. Приложение автоматически парсит данные с GitHub API и сохраняет их в базу данных PostgreSQL.

## Основные возможности

- **GET /api/repos/top100**: Возвращает список топ-100 репозиториев, отсортированных по звёздам, форкам или просмотрам.
- **GET /api/repos/{owner}/{repo}/activity**: Предоставляет информацию о ежедневной активности репозитория за указанный период (коммиты и авторы).

## Установка и запуск

### Шаг 1: Клонирование репозитория

Для начала клонируйте репозиторий и перейдите в директорию проекта:

```bash
git clone <URL-репозитория>
cd fastapi-app
```

### Шаг 2: Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта и добавьте в него следующие параметры:

```env
DATABASE_URL=postgres://user:password@db:5432/repos_db
GITHUB_API_TOKEN=your_github_token
```

Замените `your_github_token` на ваш токен доступа к GitHub API.

### Шаг 3: Запуск с помощью Docker Compose

Для запуска приложения и базы данных выполните команду:

```bash
docker-compose up --build
```

После этого приложение будет доступно по адресу:

```
http://localhost:8000/docs
```

### Шаг 4: Парсинг данных с GitHub вручную

Вы можете запустить парсер вручную с помощью следующей команды:

```bash
python app/services/parser.py
```

### Шаг 5: Деплой в Яндекс.Облако

Для автоматического деплоя парсера в Яндекс.Облако выполните команду:

```bash
bash scripts/yandex_cloud_deploy.sh
```

Скрипт создаст серверлесс-функцию и настроит триггер, который будет вызывать парсер с указанным интервалом.

## Зависимости

- Python 3.11+
- FastAPI
- Uvicorn
- PostgreSQL
- Requests

## Документация

Автодокументация доступна по адресу:

```
http://localhost:8000/docs
```

## Архитектура

Архитектура приложения разделена на несколько модулей:

1. **Маршруты (routers)**: Здесь реализованы эндпоинты для получения данных о репозиториях и их активности.
2. **Модели (models)**: Описывают структуру данных, используемых в приложении.
3. **Схемы (schemas)**: Pydantic-схемы для валидации входящих и исходящих данных.
4. **Парсер (services)**: Реализует логику взаимодействия с GitHub API и сохранения данных в базу данных.
5. **Конфигурация (config)**: Управление конфигурацией приложения через переменные окружения.
6. **Обработчики ошибок (utils/error_handlers)**: Вспомогательные функции для централизованной обработки ошибок.

## Лицензия

Этот проект лицензирован по лицензии MIT. См. файл [LICENSE](LICENSE) для получения подробной информации.
